(self["webpackChunkweb_system"]=self["webpackChunkweb_system"]||[]).push([[360],{6360:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("el-container",[e("el-main",{staticStyle:{padding:"0px",height:"calc(100vh - 60px)"}},[e("div",{attrs:{id:"container"}})]),e("el-aside",{directives:[{name:"show",rawName:"v-show",value:t.isShowDeviceInfo,expression:"isShowDeviceInfo"}],attrs:{width:"300px"}},[e("el-header",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center",height:"40px"}},[e("div",{staticClass:"l-content"},[e("h4",{staticStyle:{"margin-block-start":"0em","margin-block-end":"0em"}},[t._v("设备详情")])]),e("div",{staticClass:"r-content"},[e("el-button",{attrs:{type:"danger",icon:"el-icon-close",plain:"",circle:"",size:"mini"},on:{click:function(e){return t.colseDeviceInfo()}}})],1)]),e("el-main",{staticStyle:{padding:"0px",height:"calc(100vh - 100px)"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""}},[e("el-table-column",{attrs:{label:"属性",align:"center"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e("el-tag",{attrs:{size:"mini"}},[t._v(t._s(s.row.Key))])],1)]}}])}),e("el-table-column",{attrs:{prop:"Value",label:"值",align:"center"}})],1)],1)],1)],1)],1)},n=[],i=(s(7658),s(9483)),o=s.n(i),l=s(6028),r={data(){return{isShow:!0,ip:l.c.WebIP,map:null,mapPoints:[],isShowDeviceInfo:!1,markerClusterer:[],tableData:[{Key:"设备名称",Value:"TEST1"},{Key:"设备IP",Value:"127.0.0.1"}]}},watch:{"$store.state.deviceList":{deep:!0,handler:function(){}}},created(){this.$nextTick((()=>{this.initMap(),this.addMarker()}))},mounted(){},beforeDestroy(){},methods:{initMap(){let t=window.BMap;this.map=new t.Map("container");let e=new t.Point(108.958721,34.309588);this.map.centerAndZoom(e,6),this.map.setMinZoom(4),this.map.setMaxZoom(18),this.map.enableScrollWheelZoom(!0)},addBorderLine(){let t=window.BMap,e=[];o().forEach((s=>{var a=new t.Point(s.lng,s.lat);e.push(a)}));let s=new t.Polyline(e,{strokeColor:"red",strokeWeight:3,strokeOpacity:1});this.map.addOverlay(s)},addLine(){let t=window.BMap,e=new t.Point(113.5001,34.60468),s=new t.Point(113.7001,34.62468),a=new t.Polyline([e,s],{strokeColor:"red",strokeWeight:1,strokeOpacity:1});this.map.addOverlay(a)},addMarker(){let t=window.BMap,e=window.BMapLib;this.initPoints();let s=[];this.mapPoints.forEach(((e,a)=>{let n=new t.Marker(e,{icon:new t.Icon("http://"+this.ip+":8081/MapDownload/baidumaps/Flash-On.png",new t.Size(64,64))});s.push(n);const i="click";n.addEventListener(i,(t=>{var s=[];switch(this.tableData=[],i){case"click":break}console.log(t),console.log(e.lat),console.log(e.lng),console.log(this.$store.state.deviceList[a]);var n=this.$store.state.deviceList[a];for(let e in n)console.log(e,n[e]),"utc_time"!==e?"device_ip"!==e?"rssi_snr"!==e?s.push({Key:e,Value:n[e]}):(s.push({Key:"rssi",Value:n[e][0]}),s.push({Key:"snr",Value:n[e][1]})):s.push({Key:e,Value:n[e].split(":")[0]}):s.push({Key:e,Value:n[e][0].toString()+"-"+n[e][1].toString()+"-"+n[e][2].toString()+" "+n[e][3].toString()+":"+n[e][4].toString()+":"+n[e][5].toString()});this.tableData=s,this.clickShowDeviceInfo()})),this.map.addOverlay(n)}));let a=new e.MarkerClusterer(this.map,{markers:s,styles:[{url:"http://"+this.ip+":8081/MapDownload/baidumaps/并发数量.png",size:new t.Size(64,64)}]});a.setMinClusterSize(2),this.markerClusterer=a},convertBDCoords(t,e){const s=Math.floor(t/100),a=t%100,n=a/60,i=s+n,o=Math.floor(e/100),l=e%100,r=l/60,h=o+r;return{latitude:i,longitude:h}},outOfChina(t,e){return e<72.004||e>137.8347||(t<.8293||t>55.8271)},transformLon(t,e){const s=3.141592653589793;var a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return a+=2*(20*Math.sin(6*t*s)+20*Math.sin(2*t*s))/3,a+=2*(20*Math.sin(t*s)+40*Math.sin(t/3*s))/3,a+=2*(150*Math.sin(t/12*s)+300*Math.sin(t/30*s))/3,a},transformLat(t,e){let s=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return s+=2*(20*Math.sin(6*t*Math.PI)+20*Math.sin(2*t*Math.PI))/3,s+=2*(20*Math.sin(e*Math.PI)+40*Math.sin(e/3*Math.PI))/3,s+=2*(160*Math.sin(e/12*Math.PI)+320*Math.sin(e*Math.PI/30))/3,s},convertGpsToGcj02(t,e){const s=6378245,a=.006693421622965943;if(this.outOfChina(t,e))return{gpsLat:t,gpsLng:e};let n=this.transformLat(e-105,t-35),i=this.transformLon(e-105,t-35);const o=t/180*Math.PI;let l=Math.sin(o);l=1-a*l*l;const r=Math.sqrt(l);n=180*n/(s*(1-a)/(l*r)*Math.PI),i=180*i/(s/r*Math.cos(o)*Math.PI);const h=t+n,c=e+i;return{lat:h,lng:c}},convertBdToBd09(t,e){const s=e,a=t,n=Math.sqrt(s*s+a*a)+2e-5*Math.sin(a*Math.PI),i=Math.atan2(a,s)+3e-6*Math.cos(s*Math.PI),o=n*Math.cos(i)+.0065,l=n*Math.sin(i)+.006;return{lat:l,lng:o}},initPoints(){let t=window.BMap;for(let s=0;s<this.$store.state.deviceList.length;s++){if(0===this.$store.state.deviceList[s].pos_latitude&&0===this.$store.state.deviceList[s].pos_longitude)continue;console.log("北斗坐标：",this.$store.state.deviceList[s].pos_latitude/1e5,this.$store.state.deviceList[s].pos_longitude/1e5);const a=this.convertBDCoords(this.$store.state.deviceList[s].pos_latitude/1e5,this.$store.state.deviceList[s].pos_longitude/1e5);console.log("GPS坐标：",a);const n=this.convertGpsToGcj02(a.latitude,a.longitude);console.log("高德：",n);const i=this.convertBdToBd09(n.lat,n.lng);console.log("百度：",i);var e=new t.Point(i.lng,i.lat);this.mapPoints.push(e)}},clickShowDeviceInfo(){this.isShowDeviceInfo=!this.isShowDeviceInfo},colseDeviceInfo(){this.isShowDeviceInfo=!this.isShowDeviceInfo}}},h=r,c=s(1001),M=(0,c.Z)(h,a,n,!1,null,null,null),d=M.exports},9483:function(){function t(t,e){const s=Math.floor(t/100),a=t%100,n=a/60,i=s+n,o=Math.floor(e/100),l=e%100,r=l/60,h=o+r;return{latitude:i,longitude:h}}function e(t,e){return e<72.004||e>137.8347||(t<.8293||t>55.8271)}function s(t,e){const s=3.141592653589793;var a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return a+=2*(20*Math.sin(6*t*s)+20*Math.sin(2*t*s))/3,a+=2*(20*Math.sin(t*s)+40*Math.sin(t/3*s))/3,a+=2*(150*Math.sin(t/12*s)+300*Math.sin(t/30*s))/3,a}function a(t,e){let s=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return s+=2*(20*Math.sin(6*t*Math.PI)+20*Math.sin(2*t*Math.PI))/3,s+=2*(20*Math.sin(e*Math.PI)+40*Math.sin(e/3*Math.PI))/3,s+=2*(160*Math.sin(e/12*Math.PI)+320*Math.sin(e*Math.PI/30))/3,s}function n(t,n){const i=6378245,o=.006693421622965943;if(e(t,n))return{gpsLat:t,gpsLng:n};let l=a(n-105,t-35),r=s(n-105,t-35);const h=t/180*Math.PI;let c=Math.sin(h);c=1-o*c*c;const M=Math.sqrt(c);l=180*l/(i*(1-o)/(c*M)*Math.PI),r=180*r/(i/M*Math.cos(h)*Math.PI);const d=t+l,u=n+r;return{lat:d,lng:u}}function i(t,e){const s=e,a=t,n=Math.sqrt(s*s+a*a)+2e-5*Math.sin(a*Math.PI),i=Math.atan2(a,s)+3e-6*Math.cos(s*Math.PI),o=n*Math.cos(i)+.0065,l=n*Math.sin(i)+.006;return{lat:l,lng:o}}const o=t(2307.69398,11322.26324);console.log(o);const l=n(o.latitude,o.longitude);console.log(l);const r=i(l.lat,l.lng);console.log(r)}}]);
//# sourceMappingURL=360.9d3e4846.js.map